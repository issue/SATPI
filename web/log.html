<!doctype html>
<html data-bs-theme="light">
  <head>
    <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
		<title>SAT>IP Main Web Page</title>
		<link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/stylesheet.css" rel="stylesheet">
		<script src="assets/dist/js/jquery.min.js"></script>
    <script src="assets/dist/js/bootstrap.bundle.min.js"></script>
		<script src="assets/js/loadxmldoc.js"></script>
		<script src="assets/js/cookies.js"></script>
		<script>
			var stopScroll = false;
			var reverse;
			var checkbox;

			document.addEventListener("DOMContentLoaded", function (event) {
				checkbox = document.getElementById("reverselog");
				var reverselogCookieValue = getCookie("reverselog");
				if (reverselogCookieValue == "" && reverselogCookieValue == null) {
						setCookie("reverselog", checkbox.checked, 365);
				} else {
						checkbox.checked = reverselogCookieValue == "true" ? true : false;
				}
				reverse = checkbox.checked;
			});

			function reverseLogHandle() {
				setCookie("reverselog", checkbox.checked, 365);
				reverse = checkbox.checked;
			}

			function buildcontent(jsonString) {
				var json = JSON.parse(jsonString);
				var page = "";
				var textarea = document.getElementById("txt");

				if (stopScroll == false && reverse == true) {
						textarea.scrollTop = 0;
				} else if (stopScroll == false && reverse == false) {
						scrollToBottom();
				}

				for (i = 0; i < json.log.length; i++) {
						page += "  ";
						page += json.log[i].timestamp;
						page += "  ";
						page += json.log[i].prio;
						page += "  ";
						page += json.log[i].msg;
						page += "\n";
				}

				if (reverse == true) {
						reversedLog = page.split("\n").reverse().join("\n");
						return reversedLog;
				} else {
						return page;
				}
			}

			function updatePage() {
				loadJSONDoc("log.json");
			}
			// function called when JSON is loaded
			function jsonloaded(jsonString) {
				document.getElementById("txt").innerHTML = buildcontent(jsonString);
			}

			function scrollToBottom() {
				$("#txt").scrollTop($("#txt")[0].scrollHeight);
			}
			$("#txt").change(function () {
				scrollToBottom();
			});
			var refresh_time = 2000;
			updatePage();
			setInterval('updatePage()', refresh_time);
		</script>
  </head>
  <body>

<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
  <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">SatPI</a>
  <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  </div>
</header>

<div class="container-fluid">
  <div class="row">
    <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
      <div class="position-sticky pt-3">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="index.html">
              <span class="bi bi-house-fill" data-feather="home"></span>
              Server Info
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="log.html">
              <span class="bi bi-list-columns" data-feather="log"></span>
							Log
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="frontendoverview.html">
              <span class="bi bi-binoculars-fill" data-feather="frontend-overview"></span>
              Frontend Overview
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="frontend.html#">
              <span class="bi bi-list" data-feather="frontend"></span>
							Frontend
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="config.html">
              <span class="bi bi-gear-wide-connected" data-feather="configure"></span>
							Configure
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">
              <span class="bi bi-person-vcard-fill" data-feather="contact"></span>
							Contact
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">
              <span class="bi bi-info-circle-fill" data-feather="about"></span>
							About
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/Barracuda09/SATPI/wiki" target="_blank" rel="noopener noreferrer">
              <span class="bi bi-wikipedia" data-feather="wiki"></span>
							Wiki
            </a>
          </li>
        </ul>
    </nav>

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Server Log</h1>
      </div>
			<div class="custom-control custom-switch">
				<input type="checkbox" class="custom-control-input" id="reverselog" onclick="reverseLogHandle();">
				<label class="custom-control-label" id="reverseloglabel" for="reverselog">Reverse log</label>
			</div>
		<div class="p-1 container-log">
			<textarea id="txt" wrap="off" class="form-control logtext text-monospace" onmouseover="stopScroll = true" onmouseout="stopScroll = false" readOnly></textarea>
		</div>
    </main>
  </div>
</div>
  </body>
</html>
